<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Онлайн запись | ПапинБарбер</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <nav class="navbar navbar-expand-lg navbar-dark">
      <div class="container">
        <a class="navbar-brand" href="#">
          <img src="img/logo.png" alt="ПапинБарбер Логотип">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link active" href="index.html">Главная</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="masters.html">Мастера</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="services.html">Услуги</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="online.html">Онлайн-запись</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </header>

  <main>
    <section class="container my-5">
      <h2>ЗАПИШИСЬ НА УСЛУГУ ПРЯМО СЕЙЧАС</h2>
      <div class="row">
        <div class="col-md-6">
          <div x-data="bookingData()" x-init="init">
            <form @submit.prevent="submitBooking">
              <!-- === УСЛУГА === -->
              <div class="custom-select-wrapper mb-3">
                <div class="position-relative" style="width: 100px; height: 100px; margin: 10px;">
                  <img src="./img/service_one.jpg"   x-show="service === 'Мужская стрижка'"   class="w-100 h-100 rounded-circle object-fit-cover position-absolute">
                  <img src="./img/service_two.jpg"   x-show="service === 'Стрижка бороды'"    class="w-100 h-100 rounded-circle object-fit-cover position-absolute">
                  <img src="./img/service_three.jpg" x-show="service === 'Королевское бритьё'" class="w-100 h-100 rounded-circle object-fit-cover position-absolute">
                  <img src="./img/service_four.jpg"  x-show="service === 'Камуфляж седины'"   class="w-100 h-100 rounded-circle object-fit-cover position-absolute">
                  <img src="./img/service_five.jpg"  x-show="service === 'Детская стрижка'"   class="w-100 h-100 rounded-circle object-fit-cover position-absolute">
                  <img src="./img/service_six.jpg"   x-show="service === 'Комплекс: стрижка + борода'" class="w-100 h-100 rounded-circle object-fit-cover position-absolute">
                  <img src="./img/service_one.jpg"   x-show="!service" class="w-100 h-100 rounded-circle object-fit-cover position-absolute">
                </div>
                <select class="form-select" x-model="service" @change="updatePrice" required>
                  <option value="" disabled selected>Выберите услугу</option>
                  <option value="Мужская стрижка">Мужская стрижка</option>
                  <option value="Стрижка бороды">Стрижка бороды</option>
                  <option value="Королевское бритьё">Королевское бритьё</option>
                  <option value="Камуфляж седины">Камуфляж седины</option>
                  <option value="Детская стрижка">Детская стрижка</option>
                  <option value="Комплекс: стрижка + борода">Комплекс: стрижка + борода</option>
                </select>
              </div>

              <!-- === МАСТЕР === -->
              <div class="custom-select-wrapper mb-3">
                <div class="position-relative" style="width: 100px; height: 100px; margin: 10px;">
                  <img src="./img/master_one.jpg"   x-show="master === 'Мария'"      class="w-100 h-100 rounded-circle object-fit-cover position-absolute">
                  <img src="./img/master_two.jpg"   x-show="master === 'Алексей'"    class="w-100 h-100 rounded-circle object-fit-cover position-absolute">
                  <img src="./img/master_three.jpg" x-show="master === 'Анастасия'"  class="w-100 h-100 rounded-circle object-fit-cover position-absolute">
                  <img src="./img/master_four.jpg"  x-show="master === 'Сергей'"     class="w-100 h-100 rounded-circle object-fit-cover position-absolute">
                  <img src="./img/master_five.jpg"  x-show="master === 'Антон'"      class="w-100 h-100 rounded-circle object-fit-cover position-absolute">
                  <img src="./img/master_six.jpg"   x-show="master === 'Олег'"       class="w-100 h-100 rounded-circle object-fit-cover position-absolute">
                  <img src="./img/master_one.jpg"   x-show="!master" class="w-100 h-100 rounded-circle object-fit-cover position-absolute">
                </div>
                <select class="form-select" x-model="master" required>
                  <option value="" disabled selected>Выберите мастера</option>
                  <option value="Мария">Мария</option>
                  <option value="Алексей">Алексей</option>
                  <option value="Анастасия">Анастасия</option>
                  <option value="Сергей">Сергей</option>
                  <option value="Антон">Антон</option>
                  <option value="Олег">Олег</option>
                </select>
              </div>

              <!-- === ИМЯ (только кириллица) === -->
              <div class="mb-3">
                <div class="input-group">
                  <span class="input-group-text"><i class="bi bi-person"></i></span>
                  <input 
                    type="text" 
                    class="form-control" 
                    x-model="name" 
                    @input="validateName" 
                    placeholder="Ваше имя" 
                    required
                  >
                </div>
                <div x-show="nameError" x-transition class="text-danger small mt-1">
                  Только кириллица, без пробелов
                </div>
              </div>

              <!-- === ТЕЛЕФОН (+7 XXX XXX XX XX) === -->
              <div class="mb-3">
                <div class="input-group">
                  <span class="input-group-text"><i class="bi bi-telephone"></i></span>
                  <input 
                    type="text" 
                    class="form-control" 
                    x-model="phone" 
                    @input="formatPhone" 
                    placeholder="+7 ___ ___ __ __" 
                    maxlength="16"
                    required
                  >
                </div>
                <div x-show="phoneError" x-transition class="text-danger small mt-1">
                  Формат: +7 999 123 45 67
                </div>
              </div>

              <!-- === ДАТА (не раньше сегодня) === -->
              <div class="mb-3">
                <div class="input-group">
                  <span class="input-group-text"><i class="bi bi-calendar"></i></span>
                  <input 
                    type="date" 
                    class="form-control" 
                    x-model="date" 
                    :min="today" 
                    required
                  >
                </div>
              </div>

              <!-- === ВРЕМЯ (9:00 – 19:00) === -->
              <div class="mb-3">
                <div class="input-group">
                  <span class="input-group-text"><i class="bi bi-clock"></i></span>
                  <input 
                    type="time" 
                    class="form-control" 
                    x-model="time" 
                    min="09:00" 
                    max="19:00" 
                    @change="validateTime"
                    required
                  >
                </div>
                <div x-show="timeError" x-transition class="text-danger small mt-1">
                  Время: с 9:00 до 19:00
                </div>
              </div>

              <!-- === ЦЕНА + КНОПКА === -->
              <div class="d-flex justify-content-between align-items-center mt-3">
                <p class="fw-bold mb-0">Стоимость услуги: <span x-text="price"></span> ₽</p>
                <button 
                  type="submit" 
                  class="btn btn-red"
                  :disabled="!isFormValid"
                >ЗАПИСАТЬСЯ</button>
              </div>
            </form>
          </div>
        </div>
        <div class="col-md-6 d-flex flex-column align-items-center justify-content-start">
          <img src="./img/aesthetics.jpg" alt="Барбершоп" class="side-img">
          <img src="./img/tools.jpg" alt="Барбершоп" class="side-img">
        </div>
      </div>
    </section>

    <section class="container my-5">
      <h2>МЫ НА КАРТЕ</h2>
      <div style="position:relative;overflow:hidden;border-radius:12px;">
        <iframe src="https://yandex.ru/map-widget/v1/?um=constructor%3Aexample&id=example" width="100%" height="400" frameborder="0"></iframe>
      </div>
    </section>
  </main>

  <footer>
    <div class="footer-container">
      <div class="footer-logo">
        <a href="#">
          <img src="img/logo.png" alt="ПапинБарбер Логотип">
        </a>
      </div>
      <div class="text-center">
        <p>© ПапинБарбер, 2025 | Все права защищены</p>
        <p>8 (800) 123-45-67 | <a href="#" class="email-link">papinBarber@mail.ru</a></p>
      </div>
      <div class="social-icons">
        <a href="#" aria-label="Telegram"><i class="bi bi-telegram"></i></a>
        <a href="#" aria-label="VK"><i class="bi bi-vk"></i></a>
        <a href="#" aria-label="Instagram"><i class="bi bi-instagram"></i></a>
      </div>
    </div>
  </footer>

  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

  <script>
  function bookingData() {
    return {
      service: '',
      master: '',
      name: '',
      phone: '',
      date: '',
      time: '',
      price: '0',
      today: new Date().toISOString().split('T')[0],

      nameError: false,
      phoneError: false,
      timeError: false,

      init() {
        this.formatPhone();
      },

      updatePrice() {
        const prices = {
          'Мужская стрижка': 1200,
          'Стрижка бороды': 800,
          'Королевское бритьё': 1500,
          'Камуфляж седины': 1000,
          'Детская стрижка': 900,
          'Комплекс: стрижка + борода': 1800
        };
        this.price = prices[this.service] || '0';
      },

      validateName() {
        const regex = /^[а-яА-ЯёЁ]+$/;
        this.nameError = this.name && !regex.test(this.name);
      },

      formatPhone() {
        let value = this.phone.replace(/\D/g, '');
        if (value.startsWith('7')) value = value.slice(1);
        if (value.startsWith('8')) value = value.slice(1);
        if (value.length > 10) value = value.slice(0, 10);

        if (value) {
          value = value.replace(/(\d{3})(\d{3})(\d{2})(\d{2})/, '$1 $2 $3 $4');
          this.phone = '+7 ' + value;
        } else {
          this.phone = '';
        }

        this.phoneError = this.phone.length > 0 && this.phone.length !== 16;
      },

      validateTime() {
        this.timeError = this.time && (this.time < '09:00' || this.time > '19:00');
      },

      get isFormValid() {
        return this.service &&
               this.master &&
               this.name && !this.nameError &&
               this.phone && !this.phoneError &&
               this.date &&
               this.time && !this.timeError;
      },

      submitBooking() {
        if (this.isFormValid) {
          const bookings = JSON.parse(localStorage.getItem('bookings') || '[]');
          bookings.push({
            service: this.service,
            master: this.master,
            name: this.name,
            phone: this.phone,
            date: this.date,
            time: this.time,
            price: this.price
          });
          localStorage.setItem('bookings', JSON.stringify(bookings));
          alert('Запись успешно сохранена!');
          this.service = ''; this.master = ''; this.name = ''; this.phone = ''; this.date = ''; this.time = '';
          this.price = '0';
        }
      }
    };
  }
  </script>
</body>
</html>